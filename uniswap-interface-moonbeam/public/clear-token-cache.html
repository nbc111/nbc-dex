<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸…é™¤ä»£å¸åˆ—è¡¨ç¼“å­˜</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background: #0d1117;
            color: #c9d1d9;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        h1 { color: #58a6ff; }
        .button {
            background: #238636;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .button:hover { background: #2ea043; }
        .button-danger {
            background: #da3633;
        }
        .button-danger:hover { background: #f85149; }
        .info {
            background: #161b22;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
            border: 1px solid #30363d;
        }
        .success {
            color: #3fb950;
            background: #1a472a;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .error {
            color: #f85149;
            background: #3d1f1f;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        code {
            background: #0d1117;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸ§¹ æ¸…é™¤ä»£å¸åˆ—è¡¨ç¼“å­˜</h1>
    
    <div class="info">
        <p><strong>é—®é¢˜ï¼š</strong>ä»£å¸é€‰æ‹©å¼¹çª—ä¸­åªæ˜¾ç¤ºäº†éƒ¨åˆ†ä»£å¸ï¼ˆä¾‹å¦‚åªæ˜¾ç¤º NBC å’Œ WNBCï¼‰</p>
        <p><strong>åŸå› ï¼š</strong>æµè§ˆå™¨ localStorage ä¸­ç¼“å­˜äº†æ—§çš„ä»£å¸åˆ—è¡¨</p>
        <p><strong>è§£å†³ï¼š</strong>æ¸…é™¤ localStorage ä¸­çš„ Redux ç¼“å­˜æ•°æ®</p>
    </div>

    <div id="status"></div>

    <h2>æ“ä½œ</h2>
    <button class="button" onclick="clearReduxCache()">æ¸…é™¤ Redux ç¼“å­˜</button>
    <button class="button button-danger" onclick="clearAllLocalStorage()">æ¸…é™¤æ‰€æœ‰ localStorage</button>
    <button class="button" onclick="checkTokenList()">æ£€æŸ¥ä»£å¸åˆ—è¡¨</button>

    <h2>è¯´æ˜</h2>
    <div class="info">
        <p><strong>æ¸…é™¤ Redux ç¼“å­˜ï¼š</strong>åªæ¸…é™¤ä¸ Redux ç›¸å…³çš„ç¼“å­˜æ•°æ®ï¼Œä¿ç•™å…¶ä»–è®¾ç½®</p>
        <p><strong>æ¸…é™¤æ‰€æœ‰ localStorageï¼š</strong>æ¸…é™¤æ‰€æœ‰æœ¬åœ°å­˜å‚¨æ•°æ®ï¼ˆåŒ…æ‹¬ç”¨æˆ·è®¾ç½®ã€äº¤æ˜“å†å²ç­‰ï¼‰</p>
        <p><strong>æ£€æŸ¥ä»£å¸åˆ—è¡¨ï¼š</strong>æŸ¥çœ‹å½“å‰ localStorage ä¸­å­˜å‚¨çš„ä»£å¸åˆ—è¡¨ä¿¡æ¯</p>
    </div>

    <h2>é¢„æœŸç»“æœ</h2>
    <div class="info">
        <p>æ¸…é™¤ç¼“å­˜åï¼Œä»£å¸é€‰æ‹©å¼¹çª—åº”è¯¥æ˜¾ç¤ºä»¥ä¸‹ 12 ä¸ªä»£å¸ï¼ˆchainId 1281ï¼‰ï¼š</p>
        <ul>
            <li>NBC (NBC Token)</li>
            <li>WNBC (Wrapped NBC)</li>
            <li>BTC (Wrapped Bitcoin)</li>
            <li>ETH (Wrapped Ethereum)</li>
            <li>SOL (Wrapped Solana)</li>
            <li>BNB (Wrapped BNB)</li>
            <li>XRP (Wrapped XRP)</li>
            <li>LTC (Wrapped Litecoin)</li>
            <li>DOGE (Wrapped Dogecoin)</li>
            <li>PEPE (Pepe Token)</li>
            <li>USDT (Tether USD)</li>
            <li>SUI (Sui Token)</li>
        </ul>
    </div>

    <script>
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';
            statusDiv.innerHTML = `<div class="${className}">${message}</div>`;
        }

        function clearReduxCache() {
            try {
                let cleared = 0;
                const keys = Object.keys(localStorage);
                
                keys.forEach(key => {
                    if (key.includes('redux') || key.includes('persist') || key.includes('lists')) {
                        localStorage.removeItem(key);
                        cleared++;
                    }
                });

                if (cleared > 0) {
                    showStatus(`âœ… æˆåŠŸæ¸…é™¤äº† ${cleared} ä¸ª Redux ç›¸å…³çš„ç¼“å­˜é¡¹ã€‚è¯·åˆ·æ–° DEX é¡µé¢æŸ¥çœ‹æ•ˆæœã€‚`, 'success');
                } else {
                    showStatus('â„¹ï¸ æ²¡æœ‰æ‰¾åˆ°éœ€è¦æ¸…é™¤çš„ Redux ç¼“å­˜æ•°æ®ã€‚', 'info');
                }
            } catch (error) {
                showStatus(`âŒ æ¸…é™¤ç¼“å­˜æ—¶å‡ºé”™: ${error.message}`, 'error');
            }
        }

        function clearAllLocalStorage() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰ localStorage æ•°æ®å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰æœ¬åœ°å­˜å‚¨ï¼ŒåŒ…æ‹¬ç”¨æˆ·è®¾ç½®å’Œäº¤æ˜“å†å²ã€‚')) {
                try {
                    localStorage.clear();
                    showStatus('âœ… å·²æ¸…é™¤æ‰€æœ‰ localStorage æ•°æ®ã€‚è¯·åˆ·æ–° DEX é¡µé¢æŸ¥çœ‹æ•ˆæœã€‚', 'success');
                } catch (error) {
                    showStatus(`âŒ æ¸…é™¤ç¼“å­˜æ—¶å‡ºé”™: ${error.message}`, 'error');
                }
            }
        }

        function checkTokenList() {
            try {
                const keys = Object.keys(localStorage);
                const reduxKeys = keys.filter(key => key.includes('redux') || key.includes('persist') || key.includes('lists'));
                
                if (reduxKeys.length === 0) {
                    showStatus('â„¹ï¸ æ²¡æœ‰æ‰¾åˆ° Redux ç›¸å…³çš„ç¼“å­˜æ•°æ®ã€‚', 'info');
                    return;
                }

                let info = '<strong>æ‰¾åˆ°çš„ Redux ç¼“å­˜é”®ï¼š</strong><ul>';
                reduxKeys.forEach(key => {
                    const value = localStorage.getItem(key);
                    const size = new Blob([value]).size;
                    info += `<li><code>${key}</code> (${(size / 1024).toFixed(2)} KB)</li>`;
                });
                info += '</ul>';

                // å°è¯•è§£æ lists æ•°æ®
                reduxKeys.forEach(key => {
                    if (key.includes('lists') || key.includes('persist')) {
                        try {
                            const data = JSON.parse(localStorage.getItem(key));
                            if (data.lists) {
                                info += '<br><strong>ä»£å¸åˆ—è¡¨ä¿¡æ¯ï¼š</strong><ul>';
                                if (data.lists.byUrl) {
                                    Object.keys(data.lists.byUrl).forEach(url => {
                                        const list = data.lists.byUrl[url];
                                        if (list && list.current && list.current.tokens) {
                                            const tokenCount = list.current.tokens.length;
                                            const chain1281Count = list.current.tokens.filter(t => t.chainId === 1281).length;
                                            info += `<li>åˆ—è¡¨ <code>${url}</code>: æ€»å…± ${tokenCount} ä¸ªä»£å¸ï¼Œå…¶ä¸­ ${chain1281Count} ä¸ªæ˜¯ chainId 1281</li>`;
                                        }
                                    });
                                }
                                info += '</ul>';
                            }
                        } catch (e) {
                            // å¿½ç•¥è§£æé”™è¯¯
                        }
                    }
                });

                showStatus(info, 'info');
            } catch (error) {
                showStatus(`âŒ æ£€æŸ¥æ—¶å‡ºé”™: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.onload = function() {
            checkTokenList();
        };
    </script>
</body>
</html>

