<!DOCTYPE html>
<html>
<head>
    <title>æ£€æŸ¥ Pair</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #00ff00;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-weight: bold;
            border-radius: 3px;
        }
        pre {
            background: #000;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
            color: #00ff00;
        }
    </style>
</head>
<body>
    <h1>ğŸ” æ£€æŸ¥ BTC/ETH Pair</h1>
    <button onclick="checkPair()">æ£€æŸ¥ Pair</button>
    <button onclick="checkReserves()">æ£€æŸ¥å‚¨å¤‡é‡</button>
    <pre id="output"></pre>

    <script>
        const FACTORY = '0xf0616CCDa274b6DbFa645d70f8Dc0f617707E793';
        const BTC = '0x5EaA2c6ae3bFf47D2188B64F743Ec777733a80ac';
        const ETH = '0x934EbeB6D7D3821B604A5D10F80619d5bcBe49C3';
        
        async function checkPair() {
            const output = document.getElementById('output');
            output.textContent = 'æ£€æŸ¥ä¸­...\n';
            
            try {
                // getPair(tokenA, tokenB)
                const data = '0xe6a43905' + 
                    BTC.slice(2).padStart(64, '0') +
                    ETH.slice(2).padStart(64, '0');
                
                const result = await window.ethereum.request({
                    method: 'eth_call',
                    params: [{ to: FACTORY, data: data }, 'latest']
                });
                
                const pairAddr = '0x' + result.slice(-40);
                output.textContent += `Pair åœ°å€: ${pairAddr}\n\n`;
                
                if (pairAddr === '0x0000000000000000000000000000000000000000') {
                    output.textContent += 'âŒ Pair ä¸å­˜åœ¨ï¼éœ€è¦å…ˆåˆ›å»º Pair\n';
                    return;
                }
                
                // æ£€æŸ¥ Pair åˆçº¦ä»£ç 
                const code = await window.ethereum.request({
                    method: 'eth_getCode',
                    params: [pairAddr, 'latest']
                });
                
                if (code === '0x' || code === '0x0') {
                    output.textContent += 'âŒ Pair åˆçº¦ä¸å­˜åœ¨\n';
                } else {
                    output.textContent += `âœ… Pair åˆçº¦å­˜åœ¨ (${code.length} å­—èŠ‚)\n`;
                }
                
                window.pairAddress = pairAddr;
            } catch (err) {
                output.textContent += `âŒ é”™è¯¯: ${err.message}\n`;
            }
        }
        
        async function checkReserves() {
            const output = document.getElementById('output');
            
            if (!window.pairAddress) {
                output.textContent = 'è¯·å…ˆæ£€æŸ¥ Pair\n';
                return;
            }
            
            try {
                // getReserves()
                const data = '0x0902f1ac';
                const result = await window.ethereum.request({
                    method: 'eth_call',
                    params: [{ to: window.pairAddress, data: data }, 'latest']
                });
                
                output.textContent += '\nå‚¨å¤‡é‡:\n';
                const reserve0 = BigInt('0x' + result.slice(2, 66));
                const reserve1 = BigInt('0x' + result.slice(66, 130));
                
                output.textContent += `Reserve0: ${reserve0.toString()}\n`;
                output.textContent += `Reserve1: ${reserve1.toString()}\n`;
                
                if (reserve0 === 0n && reserve1 === 0n) {
                    output.textContent += '\nâš ï¸  å‚¨å¤‡é‡ä¸º 0ï¼ŒPair å­˜åœ¨ä½†æ²¡æœ‰æµåŠ¨æ€§\n';
                } else {
                    output.textContent += '\nâœ… Pair æœ‰æµåŠ¨æ€§\n';
                }
            } catch (err) {
                output.textContent += `\nâŒ é”™è¯¯: ${err.message}\n`;
            }
        }
    </script>
</body>
</html>
